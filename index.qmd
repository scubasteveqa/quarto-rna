---
title: "Displaying Table from PostgreSQL Database in Quarto"
---

Here's how you can display a table from a PostgreSQL database in a Quarto document:

```{python}
import pyodbc
import pandas as pd
import os
```

# Retrieve environment variables directly
```{python}
driver = os.environ.get('DB_DRIVER')
database = os.environ.get('DB_DATABASE')
uid = os.environ.get('DB_UID')
pwd = os.environ.get('DB_PWD')
server = os.environ.get('DB_SERVER')
port = os.environ.get('DB_PORT')
```
# Create the connection string for pyodbc
```{python}
connection_string = f"DRIVER={{{driver}}};DATABASE={database};UID={uid};PWD={pwd};SERVER={server};PORT={port}"
```

```{python}
# Connect to PostgreSQL database
conn = pyodbc.connect(connection_string)
```

```{python}
# Execute a query
query = "SELECT * FROM auth_permission"
```

```{python}
#Fetch all rows from the result
rows = conn.cursor().execute(query).fetchall()
```

```{python}
# Create a DataFrame from the fetched data
df = pd.DataFrame(rows, columns=[column[0] for column in conn.cursor().description])
```

```{python}
# Display the DataFrame
df
```
